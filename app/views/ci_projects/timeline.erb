<%= link_to('Configure', {:action=>'timeline_config'}, {:class=>'menu grey'}) %>
<br/>

<h1>Continuous improvement Timeline (<%= Date.today %>)</h1>

<table class="timeline_table">
	<tr>
		<th class="timeline_th_links"></th>
		<th class="timeline_th_summary">#ID - CI Name</th>
		<th class="timeline_th">Responsible</th>
		<th class="timeline_th">Validator</th>
		<th class="timeline_th">Kick-off date</th>
		<th class="timeline_th">Status</th>
		<th class="timeline_th">Validation date delay (vs initial date in weeks)</th>
		<th class="timeline_th">Deployment date delay (vs initial date in weeks)</th>
		<th class="timeline_th">Planning external validation</th>
		<% @dates.each do |date| %>
			<th class="timeline_th_date">
			<span class="<%= date.date_th_span %>"><%= date.date_string %></span>
			</th>
		<% end %>
	</tr>

	<% @timeline_projects_sorted.each do |project| %>
	<% blue_box = project.in_progress %>
	<tr class="timeline_tr">
		<!-- 0 = nothing, 1 = father, 2 = son, 3 = brother -->
		<% if project.link_type == 2 %>
			<td>
			<img src="/images/arrow.png" style="width:20px;height:20px;"></td>
			<td><%= project.id %> - <%= project.name %></td>
		<% elsif project.link_type == 3 %>
			<td>
			<img src="/images/arrow_double.png" style="width:20px;height:17px;"></td>
			<td><%= project.id %> - <%= project.name %></td>
		<% else %>
			<td colspan=2><%= project.id %> - <%= project.name %></td>
		<% end %>
		<td class="timeline_td"><%= project.responsible %></td>
		<td class="timeline_td"><%= project.validator %></td>
		<td class="timeline_td"><%= project.start_date %></td>
		<td class="<%= project.status_color %>"><%= project.status %></td>
		<td class="<%= project.validation_date_delay_color %>"><%= project.validation_date_delay %></td>
		<td class="<%= project.deployment_date_delay_color %>"><%= project.deployment_date_delay %></td>
		<td class="timeline_td"><%= project.planning_external_validation %></td>
		<% @dates.each do |date| %>
			<% if blue_box == true and project.validation_date_week != date.date_week and project.deployment_date_week != date.date_week %>
				<td class="timeline_td_progress"></td>
			<% elsif project.validation_date_week == date.date_week and project.deployment_date_week == date.date_week %>
				<td class="timeline_td_date_val_dep">VD</td>
				<% blue_box = false %>
			<% elsif project.start_date_week == date.date_week %>
				<td class="timeline_td_date_start">S</td>
				<% blue_box = true %>
			<% elsif project.validation_date_week == date.date_week %>
				<td class="timeline_td_date_val_dep">V</td>
				<% blue_box = false %>
			<% elsif project.deployment_date_week == date.date_week %>
				<td class="timeline_td_date_val_dep">D</td>
				<% blue_box = false %>
			<% else %>
				<td class="<%= date.date_td_span %>"></td>
			<% end %>
		<% end %>
	</tr>

	<% if project.id == "0" %>
		<% #raise project.deployment_date_week.to_s %>
	<% end %>

	<% end %>
</table>

<br/><br/>

<table class="caption_table">
<tr>
	<td colspan=3 class="caption_title">Caption</td>
</tr><tr class="caption_tr">
	<td>
		<table>
		<tr>
			<td colspan=2>EISQ Status vs Change Request Airbus</td>
		</tr>
		<tr>
			<td class="caption_td_new">New</td>
			<td class="caption_td_new">Waiting CCB</td>
		</tr>
		<tr>
			<td class="caption_td_qualification">Qualification</td>
			<td class="caption_td_qualification">Waiting Kick-off</td>
		</tr>
		<tr>
			<td class="caption_td_assigned">Assigned</td>
			<td class="caption_td_assigned">Running</td>
		</tr>
		<tr>
			<td class="caption_td_assigned">Verified</td>
			<td class="caption_td_assigned">Running</td>
		</tr>
		<tr>
			<td class="caption_td_assigned">Validated</td>
			<td class="caption_td_assigned">Running</td>
		</tr>
		<tr>
			<td class="caption_td_delivered">Delivered</td>
			<td class="caption_td_delivered">Deployed</td>
		</tr>
		<tr>
			<td>Comment</td>
			<td>On hold</td>
		</tr>
		</table>
	</td>
	<td></td>
	<td></td>
</tr>
</table>

